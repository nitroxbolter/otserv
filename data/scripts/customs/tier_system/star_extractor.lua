local extractionTable = {
        -- Common --
        [26813] = {transformId = 27113, addItem = 27134},
        [26814] = {transformId = 27113, addItem = 27135},
        [26815] = {transformId = 27113, addItem = 27136},
        [26816] = {transformId = 27114, addItem = 27134},
        [26817] = {transformId = 27114, addItem = 27135},
        [26818] = {transformId = 27114, addItem = 27136},
        [26819] = {transformId = 27115, addItem = 27134},
        [26820] = {transformId = 27115, addItem = 27135},
        [26821] = {transformId = 27115, addItem = 27136},
        [26822] = {transformId = 27116, addItem = 27134},
        [26823] = {transformId = 27116, addItem = 27135},
        [26824] = {transformId = 27116, addItem = 27136},
        [26825] = {transformId = 27117, addItem = 27134},
        [26826] = {transformId = 27117, addItem = 27135},
        [26827] = {transformId = 27117, addItem = 27136},
        [26828] = {transformId = 27118, addItem = 27134},
        [26829] = {transformId = 27118, addItem = 27135},
        [26830] = {transformId = 27118, addItem = 27136},
        [26831] = {transformId = 27119, addItem = 27134},
        [26832] = {transformId = 27119, addItem = 27135},
        [26833] = {transformId = 27119, addItem = 27136},
        [26834] = {transformId = 27120, addItem = 27134},
        [26835] = {transformId = 27120, addItem = 27135},
        [26836] = {transformId = 27120, addItem = 27136},
        [26837] = {transformId = 27121, addItem = 27134},
        [26838] = {transformId = 27121, addItem = 27135},
        [26839] = {transformId = 27121, addItem = 27136},
        [26840] = {transformId = 27122, addItem = 27134},
        [26841] = {transformId = 27122, addItem = 27135},
        [26842] = {transformId = 27122, addItem = 27136},
        [26843] = {transformId = 27123, addItem = 27134},
        [26844] = {transformId = 27123, addItem = 27135},
        [26845] = {transformId = 27123, addItem = 27136},
        [26846] = {transformId = 27124, addItem = 27134},
        [26847] = {transformId = 27124, addItem = 27135},
        [26848] = {transformId = 27124, addItem = 27136},
        [26849] = {transformId = 27125, addItem = 27134},
        [26850] = {transformId = 27125, addItem = 27135},
        [26851] = {transformId = 27125, addItem = 27136},
        [26852] = {transformId = 27126, addItem = 27134},
        [26853] = {transformId = 27126, addItem = 27135},
        [26854] = {transformId = 27126, addItem = 27136},
        [26855] = {transformId = 27127, addItem = 27134},
        [26856] = {transformId = 27127, addItem = 27135},
        [26857] = {transformId = 27127, addItem = 27136},
        [26858] = {transformId = 27128, addItem = 27134},
        [26859] = {transformId = 27128, addItem = 27135},
        [26860] = {transformId = 27128, addItem = 27136},
        [26861] = {transformId = 27129, addItem = 27134},
        [26862] = {transformId = 27129, addItem = 27135},
        [26863] = {transformId = 27129, addItem = 27136},
        [26864] = {transformId = 27130, addItem = 27134},
        [26865] = {transformId = 27130, addItem = 27135},
        [26866] = {transformId = 27130, addItem = 27136},
        [26867] = {transformId = 27131, addItem = 27134},
        [26868] = {transformId = 27131, addItem = 27135},
        [26869] = {transformId = 27131, addItem = 27136},
        [26870] = {transformId = 27132, addItem = 27134},
        [26871] = {transformId = 27132, addItem = 27135},
        [26872] = {transformId = 27132, addItem = 27136},
        -- Rare --
        [26873] = {transformId = 27113, addItem = 27137},
        [26874] = {transformId = 27113, addItem = 27138},
        [26875] = {transformId = 27113, addItem = 27139},
        [26876] = {transformId = 27114, addItem = 27137},
        [26877] = {transformId = 27114, addItem = 27138},
        [26878] = {transformId = 27114, addItem = 27139},
        [26879] = {transformId = 27115, addItem = 27137},
        [26880] = {transformId = 27115, addItem = 27138},
        [26881] = {transformId = 27115, addItem = 27139},
        [26882] = {transformId = 27116, addItem = 27137},
        [26883] = {transformId = 27116, addItem = 27138},
        [26884] = {transformId = 27116, addItem = 27139},
        [26885] = {transformId = 27117, addItem = 27137},
        [26886] = {transformId = 27117, addItem = 27138},
        [26887] = {transformId = 27117, addItem = 27139},
        [26888] = {transformId = 27118, addItem = 27137},
        [26889] = {transformId = 27118, addItem = 27138},
        [26890] = {transformId = 27118, addItem = 27139},
        [26891] = {transformId = 27119, addItem = 27137},
        [26892] = {transformId = 27119, addItem = 27138},
        [26893] = {transformId = 27119, addItem = 27139},
        [26894] = {transformId = 27120, addItem = 27137},
        [26895] = {transformId = 27120, addItem = 27138},
        [26896] = {transformId = 27120, addItem = 27139},
        [26897] = {transformId = 27121, addItem = 27137},
        [26898] = {transformId = 27121, addItem = 27138},
        [26899] = {transformId = 27121, addItem = 27139},
        [26900] = {transformId = 27122, addItem = 27137},
        [26901] = {transformId = 27122, addItem = 27138},
        [26902] = {transformId = 27122, addItem = 27139},
        [26903] = {transformId = 27123, addItem = 27137},
        [26904] = {transformId = 27123, addItem = 27138},
        [26905] = {transformId = 27123, addItem = 27139},
        [26906] = {transformId = 27124, addItem = 27137},
        [26907] = {transformId = 27124, addItem = 27138},
        [26908] = {transformId = 27124, addItem = 27139},
        [26909] = {transformId = 27125, addItem = 27137},
        [26910] = {transformId = 27125, addItem = 27138},
        [26911] = {transformId = 27125, addItem = 27139},
        [26912] = {transformId = 27126, addItem = 27137},
        [26913] = {transformId = 27126, addItem = 27138},
        [26914] = {transformId = 27126, addItem = 27139},
        [26915] = {transformId = 27127, addItem = 27137},
        [26916] = {transformId = 27127, addItem = 27138},
        [26917] = {transformId = 27127, addItem = 27139},
        [26918] = {transformId = 27128, addItem = 27137},
        [26919] = {transformId = 27128, addItem = 27138},
        [26920] = {transformId = 27128, addItem = 27139},
        [26921] = {transformId = 27129, addItem = 27137},
        [26922] = {transformId = 27129, addItem = 27138},
        [26923] = {transformId = 27129, addItem = 27139},
        [26924] = {transformId = 27130, addItem = 27137},
        [26925] = {transformId = 27130, addItem = 27138},
        [26926] = {transformId = 27130, addItem = 27139},
        [26927] = {transformId = 27131, addItem = 27137},
        [26928] = {transformId = 27131, addItem = 27138},
        [26929] = {transformId = 27131, addItem = 27139},
        [26930] = {transformId = 27132, addItem = 27137},
        [26931] = {transformId = 27132, addItem = 27138},
        [26932] = {transformId = 27132, addItem = 27139},
        -- Very Rare --
        [26933] = {transformId = 27113, addItem = 27140},
        [26934] = {transformId = 27113, addItem = 27141},
        [26935] = {transformId = 27113, addItem = 27142},
        [26936] = {transformId = 27114, addItem = 27140},
        [26937] = {transformId = 27114, addItem = 27141},
        [26938] = {transformId = 27114, addItem = 27142},
        [26939] = {transformId = 27115, addItem = 27140},
        [26940] = {transformId = 27115, addItem = 27141},
        [26941] = {transformId = 27115, addItem = 27142},
        [26942] = {transformId = 27116, addItem = 27140},
        [26943] = {transformId = 27116, addItem = 27141},
        [26944] = {transformId = 27116, addItem = 27142},
        [26945] = {transformId = 27117, addItem = 27140},
        [26946] = {transformId = 27117, addItem = 27141},
        [26947] = {transformId = 27117, addItem = 27142},
        [26948] = {transformId = 27118, addItem = 27140},
        [26949] = {transformId = 27118, addItem = 27141},
        [26950] = {transformId = 27118, addItem = 27142},
        [26951] = {transformId = 27119, addItem = 27140},
        [26952] = {transformId = 27119, addItem = 27141},
        [26953] = {transformId = 27119, addItem = 27142},
        [26954] = {transformId = 27120, addItem = 27140},
        [26955] = {transformId = 27120, addItem = 27141},
        [26956] = {transformId = 27120, addItem = 27142},
        [26957] = {transformId = 27121, addItem = 27140},
        [26958] = {transformId = 27121, addItem = 27141},
        [26959] = {transformId = 27121, addItem = 27142},
        [26960] = {transformId = 27122, addItem = 27140},
        [26961] = {transformId = 27122, addItem = 27141},
        [26962] = {transformId = 27122, addItem = 27142},
        [26963] = {transformId = 27123, addItem = 27140},
        [26964] = {transformId = 27123, addItem = 27141},
        [26965] = {transformId = 27123, addItem = 27142},
        [26966] = {transformId = 27124, addItem = 27140},
        [26967] = {transformId = 27124, addItem = 27141},
        [26968] = {transformId = 27124, addItem = 27142},
        [26969] = {transformId = 27125, addItem = 27140},
        [26970] = {transformId = 27125, addItem = 27141},
        [26971] = {transformId = 27125, addItem = 27142},
        [26972] = {transformId = 27126, addItem = 27140},
        [26973] = {transformId = 27126, addItem = 27141},
        [26974] = {transformId = 27126, addItem = 27142},
        [26975] = {transformId = 27127, addItem = 27140},
        [26976] = {transformId = 27127, addItem = 27141},
        [26977] = {transformId = 27127, addItem = 27142},
        [26978] = {transformId = 27128, addItem = 27140},
        [26979] = {transformId = 27128, addItem = 27141},
        [26980] = {transformId = 27128, addItem = 27142},
        [26981] = {transformId = 27129, addItem = 27140},
        [26982] = {transformId = 27129, addItem = 27141},
        [26983] = {transformId = 27129, addItem = 27142},
        [26984] = {transformId = 27130, addItem = 27140},
        [26985] = {transformId = 27130, addItem = 27141},
        [26986] = {transformId = 27130, addItem = 27142},
        [26987] = {transformId = 27131, addItem = 27140},
        [26988] = {transformId = 27131, addItem = 27141},
        [26989] = {transformId = 27131, addItem = 27142},
        [26990] = {transformId = 27132, addItem = 27140},
        [26991] = {transformId = 27132, addItem = 27141},
        [26992] = {transformId = 27132, addItem = 27142},
        -- Epic --
        [26993] = {transformId = 27113, addItem = 27143},
        [26994] = {transformId = 27113, addItem = 27144},
        [26995] = {transformId = 27113, addItem = 27145},
        [26996] = {transformId = 27114, addItem = 27143},
        [26997] = {transformId = 27114, addItem = 27144},
        [26998] = {transformId = 27114, addItem = 27145},
        [26999] = {transformId = 27115, addItem = 27143},
        [27000] = {transformId = 27115, addItem = 27144},
        [27001] = {transformId = 27115, addItem = 27145},
        [27002] = {transformId = 27116, addItem = 27143},
        [27003] = {transformId = 27116, addItem = 27144},
        [27004] = {transformId = 27116, addItem = 27145},
        [27005] = {transformId = 27117, addItem = 27143},
        [27006] = {transformId = 27117, addItem = 27144},
        [27007] = {transformId = 27117, addItem = 27145},
        [27008] = {transformId = 27118, addItem = 27143},
        [27009] = {transformId = 27118, addItem = 27144},
        [27010] = {transformId = 27118, addItem = 27145},
        [27011] = {transformId = 27119, addItem = 27143},
        [27012] = {transformId = 27119, addItem = 27144},
        [27013] = {transformId = 27119, addItem = 27145},
        [27014] = {transformId = 27120, addItem = 27143},
        [27015] = {transformId = 27120, addItem = 27144},
        [27016] = {transformId = 27120, addItem = 27145},
        [27017] = {transformId = 27121, addItem = 27143},
        [27018] = {transformId = 27121, addItem = 27144},
        [27019] = {transformId = 27121, addItem = 27145},
        [27020] = {transformId = 27122, addItem = 27143},
        [27021] = {transformId = 27122, addItem = 27144},
        [27022] = {transformId = 27122, addItem = 27145},
        [27023] = {transformId = 27123, addItem = 27143},
        [27024] = {transformId = 27123, addItem = 27144},
        [27025] = {transformId = 27123, addItem = 27145},
        [27026] = {transformId = 27124, addItem = 27143},
        [27027] = {transformId = 27124, addItem = 27144},
        [27028] = {transformId = 27124, addItem = 27145},
        [27029] = {transformId = 27125, addItem = 27143},
        [27030] = {transformId = 27125, addItem = 27144},
        [27031] = {transformId = 27125, addItem = 27145},
        [27032] = {transformId = 27126, addItem = 27143},
        [27033] = {transformId = 27126, addItem = 27144},
        [27034] = {transformId = 27126, addItem = 27145},
        [27035] = {transformId = 27127, addItem = 27143},
        [27036] = {transformId = 27127, addItem = 27144},
        [27037] = {transformId = 27127, addItem = 27145},
        [27038] = {transformId = 27128, addItem = 27143},
        [27039] = {transformId = 27128, addItem = 27144},
        [27040] = {transformId = 27128, addItem = 27145},
        [27041] = {transformId = 27129, addItem = 27143},
        [27042] = {transformId = 27129, addItem = 27144},
        [27043] = {transformId = 27129, addItem = 27145},
        [27044] = {transformId = 27130, addItem = 27143},
        [27045] = {transformId = 27130, addItem = 27144},
        [27046] = {transformId = 27130, addItem = 27145},
        [27047] = {transformId = 27131, addItem = 27143},
        [27048] = {transformId = 27131, addItem = 27144},
        [27049] = {transformId = 27131, addItem = 27145},
        [27050] = {transformId = 27132, addItem = 27143},
        [27051] = {transformId = 27132, addItem = 27144},
        [27052] = {transformId = 27132, addItem = 27145},
        -- Legendary --
        [27053] = {transformId = 27113, addItem = 27146},
        [27054] = {transformId = 27113, addItem = 27147},
        [27055] = {transformId = 27113, addItem = 27148},
        [27056] = {transformId = 27114, addItem = 27146},
        [27057] = {transformId = 27114, addItem = 27147},
        [27058] = {transformId = 27114, addItem = 27148},
        [27059] = {transformId = 27115, addItem = 27146},
        [27060] = {transformId = 27115, addItem = 27147},
        [27061] = {transformId = 27115, addItem = 27148},
        [27062] = {transformId = 27116, addItem = 27146},
        [27063] = {transformId = 27116, addItem = 27147},
        [27064] = {transformId = 27116, addItem = 27148},
        [27065] = {transformId = 27117, addItem = 27146},
        [27066] = {transformId = 27117, addItem = 27147},
        [27067] = {transformId = 27117, addItem = 27148},
        [27068] = {transformId = 27118, addItem = 27146},
        [27069] = {transformId = 27118, addItem = 27147},
        [27070] = {transformId = 27118, addItem = 27148},
        [27071] = {transformId = 27119, addItem = 27146},
        [27072] = {transformId = 27119, addItem = 27147},
        [27073] = {transformId = 27119, addItem = 27148},
        [27074] = {transformId = 27120, addItem = 27146},
        [27075] = {transformId = 27120, addItem = 27147},
        [27076] = {transformId = 27120, addItem = 27148},
        [27077] = {transformId = 27121, addItem = 27146},
        [27078] = {transformId = 27121, addItem = 27147},
        [27079] = {transformId = 27121, addItem = 27148},
        [27080] = {transformId = 27122, addItem = 27146},
        [27081] = {transformId = 27122, addItem = 27147},
        [27082] = {transformId = 27122, addItem = 27148},
        [27083] = {transformId = 27123, addItem = 27146},
        [27084] = {transformId = 27123, addItem = 27147},
        [27085] = {transformId = 27123, addItem = 27148},
        [27086] = {transformId = 27124, addItem = 27146},
        [27087] = {transformId = 27124, addItem = 27147},
        [27088] = {transformId = 27124, addItem = 27148},
        [27089] = {transformId = 27125, addItem = 27146},
        [27090] = {transformId = 27125, addItem = 27147},
        [27091] = {transformId = 27125, addItem = 27148},
        [27092] = {transformId = 27126, addItem = 27146},
        [27093] = {transformId = 27126, addItem = 27147},
        [27094] = {transformId = 27126, addItem = 27148},
        [27095] = {transformId = 27127, addItem = 27146},
        [27096] = {transformId = 27127, addItem = 27147},
        [27097] = {transformId = 27127, addItem = 27148},
        [27098] = {transformId = 27128, addItem = 27146},
        [27099] = {transformId = 27128, addItem = 27147},
        [27100] = {transformId = 27128, addItem = 27148},
        [27101] = {transformId = 27129, addItem = 27146},
        [27102] = {transformId = 27129, addItem = 27147},
        [27103] = {transformId = 27129, addItem = 27148},
        [27104] = {transformId = 27130, addItem = 27146},
        [27105] = {transformId = 27130, addItem = 27147},
        [27106] = {transformId = 27130, addItem = 27148},
        [27107] = {transformId = 27131, addItem = 27146},
        [27108] = {transformId = 27131, addItem = 27147},
        [27109] = {transformId = 27131, addItem = 27148},
        [27110] = {transformId = 27132, addItem = 27146},
        [27111] = {transformId = 27132, addItem = 27147},
        [27112] = {transformId = 27132, addItem = 27148},

    }
    
    local starExtractor = Action()
    
    function starExtractor.onUse(player, item, fromPosition, target, toPosition, isHotkey)
        if not target:isItem() then
            player:sendCancelMessage('You must select an item.')
            player:sendMagicEffect(CONST_ME_POFF)
            return true
        end
    
        local targetId = target.itemid
        local extractionData = extractionTable[targetId]
    
        if extractionData then
            target:transform(extractionData.transformId)
            player:addItem(extractionData.addItem, 1)
            player:sendTextMessage(MESSAGE_INFO_DESCR, "Successfully extracted.")
            player:getPosition():sendMagicEffect(211)
            item:remove(1)
        else
            player:sendCancelMessage('Extraction not defined for this item.')
        end
    
        return true
    end
    
    starExtractor:id(27149)
    starExtractor:register()
    